<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Refine Filters – Nextreel</title>
  <meta name="description" content="Fine-tune your movie recommendations by score, votes, year, and genre." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- Compiled Tailwind CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
  <style>
    :root { color-scheme: light dark; }
    body { font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif; }
    .font-brand-serif { font-family: 'Merriweather', Georgia, Cambria, 'Times New Roman', Times, serif; }
  </style>
</head>
<body class="bg-white text-slate-800 dark:bg-slate-950 dark:text-slate-100 antialiased">
  <a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:rounded-md focus:bg-white focus:px-3 focus:py-2 focus:text-sm focus:shadow dark:focus:bg-slate-900">Skip to content</a>

  <!-- Tailwind Navbar (kept consistent with home) -->
  <header class="sticky top-0 z-50 bg-primary/95 backdrop-blur supports-[backdrop-filter]:bg-primary/80 text-white shadow">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <a href="/" class="flex items-center gap-2 group" aria-label="Nextreel home">
          <svg class="h-6 w-6 transition-transform group-hover:rotate-6" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M4 6a2 2 0 0 1 2-2h8l6 6v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6z" opacity=".3"/>
            <path d="M14 4v4a2 2 0 0 0 2 2h4"/>
          </svg>
          <span class="font-brand-serif text-xl font-bold tracking-tight">Nextreel</span>
        </a>
        <nav class="hidden gap-2 md:flex">
          <a href="/next_movie" class="inline-flex items-center gap-2 rounded-xl bg-accent px-4 py-2 text-sm font-semibold text-white shadow hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent/70 focus:ring-offset-primary/20">
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
            Pick a Movie
          </a>
          <a href="/setFilters" aria-current="page" class="inline-flex items-center gap-2 rounded-xl border border-accent px-4 py-2 text-sm font-semibold text-accent bg-white/0 hover:bg-accent/10 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent/70 focus:ring-offset-primary/20">
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 5h18v2H3zm4 6h10v2H7zm3 6h4v2h-4z"/></svg>
            Set Filters
          </a>
        </nav>
        <button id="menuBtn" class="inline-flex items-center justify-center rounded-lg p-2 hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white md:hidden" aria-controls="mobileMenu" aria-expanded="false" aria-label="Open menu">
          <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/></svg>
        </button>
      </div>
    </div>
    <div id="mobileMenu" class="hidden md:hidden border-t border-white/10">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-3 space-y-2">
        <a href="/next_movie" class="block w-full rounded-lg bg-accent px-4 py-2 text-sm font-semibold text-white text-center">Pick a Movie</a>
        <a href="/setFilters" class="block w-full rounded-lg border border-accent px-4 py-2 text-sm font-semibold text-accent text-center">Set Filters</a>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative isolate">
    <div class="absolute inset-0 -z-10 bg-gradient-to-br from-primary via-primary/90 to-slate-900"></div>
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex min-h-[40vh] items-center justify-center py-12 text-center">
        <div class="max-w-3xl text-white">
          <h1 class="font-brand-serif text-3xl sm:text-4xl font-extrabold tracking-tight">Customize Your Queue</h1>
          <p class="mt-3 text-sm/7 sm:text-base/7 opacity-90">Fine‑tune the movies you see by adjusting score, votes, release year and genres.</p>
          <div class="mt-6 flex items-center justify-center gap-3">
            <a href="#filters" class="inline-flex items-center gap-2 rounded-2xl bg-accent px-5 py-2.5 text-sm font-semibold text-white shadow hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-white">Jump to Filters</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Filters Card -->
  <main id="main">
    <section id="filters" class="py-12 sm:py-16 bg-slate-50 dark:bg-slate-900/40">
      <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
        <form action="/filtered_movie" method="post" class="rounded-2xl bg-white dark:bg-slate-900 p-6 sm:p-8 shadow-soft ring-1 ring-slate-200/60 dark:ring-white/10 border-t-4 border-accent">
          <div class="grid grid-cols-1 gap-8 md:grid-cols-2">
            <!-- Left column -->
            <div class="space-y-8">
              <!-- Score Range -->
              <section aria-labelledby="score-heading" class="space-y-3">
                <h2 id="score-heading" class="flex items-center text-lg font-semibold text-primary dark:text-white">
                  <svg class="mr-2 h-5 w-5 text-accent" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                  IMDb Score Range
                </h2>
                <div>
                  <label for="imdb_score_min" class="block text-sm font-medium">Min Score</label>
                  <input type="number" id="imdb_score_min" name="imdb_score_min" min="1" max="10" step="0.1" value="{{ current_filters.get('imdb_score_min', 7.0) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
                <div>
                  <label for="imdb_score_max" class="block text-sm font-medium">Max Score</label>
                  <input type="number" id="imdb_score_max" name="imdb_score_max" min="1" max="10" step="0.1" value="{{ current_filters.get('imdb_score_max', 10.0) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
              </section>

              <!-- Vote Range -->
              <section aria-labelledby="votes-heading" class="space-y-3">
                <h2 id="votes-heading" class="flex items-center text-lg font-semibold text-primary dark:text-white">
                  <svg class="mr-2 h-5 w-5 text-accent" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4 8 5.79 8 8s1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                  Vote Count Range
                </h2>
                <div>
                  <label for="num_votes_min" class="block text-sm font-medium">Min Votes</label>
                  <input type="number" id="num_votes_min" name="num_votes_min" min="0" value="{{ current_filters.get('num_votes_min', 100000) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
                <div>
                  <label for="num_votes_max" class="block text-sm font-medium">Max Votes</label>
                  <input type="number" id="num_votes_max" name="num_votes_max" min="1" max="2000000" value="{{ current_filters.get('num_votes_max', 200000) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
              </section>
            </div>

            <!-- Right column -->
            <div class="space-y-8">
              <!-- Year Range -->
              <section aria-labelledby="year-heading" class="space-y-3">
                <h2 id="year-heading" class="flex items-center text-lg font-semibold text-primary dark:text-white">
                  <svg class="mr-2 h-5 w-5 text-accent" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 4h-1V2h-2v2H8V2H6v2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 16H5V10h14v10z"/></svg>
                  Release Year Range
                </h2>
                <div>
                  <label for="year_min" class="block text-sm font-medium">Earliest</label>
                  <input type="number" id="year_min" name="year_min" min="1900" value="{{ current_filters.get('year_min', 1900) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
                <div>
                  <label for="year_max" class="block text-sm font-medium">Latest</label>
                  <input type="number" id="year_max" name="year_max" value="{{ current_filters.get('year_max', 2023) }}" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30">
                </div>
              </section>

              <!-- Language Selection -->
              <section aria-labelledby="language-heading" class="space-y-3">
                <h2 id="language-heading" class="flex items-center text-lg font-semibold text-primary dark:text-white">
                  <svg class="mr-2 h-5 w-5 text-accent" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/>
                  </svg>
                  Language
                </h2>
                <div>
                  <label for="language" class="block text-sm font-medium">Select Language</label>
                  <select id="language" name="language" class="mt-1 w-full rounded-2xl border-2 border-slate-200 px-4 py-2.5 text-sm shadow-sm focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/30 dark:bg-slate-800 dark:border-slate-700 dark:text-white">
                    <option value="any" {% if current_filters.get('language', 'en') == 'any' %}selected{% endif %}>Any Language</option>
                    <option value="en" {% if current_filters.get('language', 'en') == 'en' %}selected{% endif %}>English</option>
                    <option value="es" {% if current_filters.get('language') == 'es' %}selected{% endif %}>Spanish</option>
                    <option value="fr" {% if current_filters.get('language') == 'fr' %}selected{% endif %}>French</option>
                    <option value="de" {% if current_filters.get('language') == 'de' %}selected{% endif %}>German</option>
                    <option value="it" {% if current_filters.get('language') == 'it' %}selected{% endif %}>Italian</option>
                    <option value="pt" {% if current_filters.get('language') == 'pt' %}selected{% endif %}>Portuguese</option>
                    <option value="ru" {% if current_filters.get('language') == 'ru' %}selected{% endif %}>Russian</option>
                    <option value="ja" {% if current_filters.get('language') == 'ja' %}selected{% endif %}>Japanese</option>
                    <option value="ko" {% if current_filters.get('language') == 'ko' %}selected{% endif %}>Korean</option>
                    <option value="zh" {% if current_filters.get('language') == 'zh' %}selected{% endif %}>Chinese</option>
                    <option value="hi" {% if current_filters.get('language') == 'hi' %}selected{% endif %}>Hindi</option>
                    <option value="ar" {% if current_filters.get('language') == 'ar' %}selected{% endif %}>Arabic</option>
                    <option value="tr" {% if current_filters.get('language') == 'tr' %}selected{% endif %}>Turkish</option>
                    <option value="nl" {% if current_filters.get('language') == 'nl' %}selected{% endif %}>Dutch</option>
                    <option value="sv" {% if current_filters.get('language') == 'sv' %}selected{% endif %}>Swedish</option>
                    <option value="pl" {% if current_filters.get('language') == 'pl' %}selected{% endif %}>Polish</option>
                  </select>
                </div>
              </section>

              <!-- Genres -->
              <section aria-labelledby="genres-heading" class="space-y-3">
                <h2 id="genres-heading" class="flex items-center text-lg font-semibold text-primary dark:text-white">
                  <svg class="mr-2 h-5 w-5 text-accent" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M20 2H8c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v10a2 2 0 0 0 2 2h12c1.1 0 2-.9 2-2v-2h2c1.1 0 2-.9 2-2V4a2 2 0 0 0-2-2zm-4 16H4V8h12v10zm4-4h-2V4h2v10z"/></svg>
                  Select Genres
                </h2>
                <div class="flex items-center gap-2 text-sm font-medium">
                  <input type="checkbox" id="selectAll" checked class="h-4 w-4 rounded border-slate-300 text-accent focus:ring-accent" />
                  <label for="selectAll">Select All</label>
                </div>
                <div class="genre-grid mt-2 flex flex-wrap gap-2">
                  {% set genres = ['Action','Adventure','Animation','Biography','Comedy','Crime','Documentary','Drama','Fantasy','Horror','Musical','Sci-Fi','Sport','Thriller','War','Western'] %}
                  {% for g in genres %}
                  <label class="relative">
                    <input type="checkbox" name="genres[]" value="{{ g }}" {% if current_filters.get('genres_selected', [])|length == 0 or g in current_filters.get('genres_selected', []) %}checked{% endif %} class="peer sr-only" />
                    <span class="inline-block select-none rounded-full border-2 border-slate-300 bg-slate-50 px-4 py-2 text-xs font-semibold text-slate-700 transition peer-checked:border-accent peer-checked:bg-accent peer-checked:text-white">{{ g }}</span>
                  </label>
                  {% endfor %}
                </div>
              </section>
            </div>
          </div>

          <!-- Buttons -->
          <div class="mt-10 flex items-center justify-center gap-3">
            <button type="reset" class="inline-flex items-center justify-center rounded-full bg-slate-200 px-6 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-primary/30">Reset</button>
            <button type="submit" class="inline-flex items-center justify-center rounded-full bg-accent px-7 py-3 text-sm font-bold uppercase tracking-wide text-white shadow shadow-black/10 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-accent/40">Apply Filters</button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <!-- Footer (simple) -->
  <footer class="border-t border-slate-200/60 dark:border-white/10 bg-white dark:bg-slate-950">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-10">
      <div class="grid gap-8 md:grid-cols-3 md:items-start">
        <div>
          <a href="/" class="inline-flex items-center gap-2 text-primary dark:text-white">
            <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 6a2 2 0 0 1 2-2h8l6 6v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6z" opacity=".3"/><path d="M14 4v4a2 2 0 0 0 2 2h4"/></svg>
            <span class="font-brand-serif text-lg font-bold">Nextreel</span>
          </a>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-400">&copy; 2025 Nextreel. All rights reserved.</p>
        </div>
        <div class="text-sm">
          <ul class="space-y-2">
            <li><a class="text-slate-600 hover:text-primary dark:text-slate-300 dark:hover:text-white" href="#">About Us</a></li>
            <li><a class="text-slate-600 hover:text-primary dark:text-slate-300 dark:hover:text-white" href="#">Privacy Policy</a></li>
            <li><a class="text-slate-600 hover:text-primary dark:text-slate-300 dark:hover:text-white" href="#">DMCA</a></li>
          </ul>
        </div>
        <div class="text-sm">
          <h3 class="font-semibold text-slate-900 dark:text-white">Contact</h3>
          <p class="mt-2 text-slate-600 dark:text-slate-300">Email: <a class="underline decoration-accent/50 underline-offset-4 hover:decoration-accent" href="mailto:bryce@nxtreel.com">bryce@nxtreel.com</a></p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Tiny JS: navbar toggle + Select All -->
  <script>
    // Navbar mobile toggle
    const menuBtn = document.getElementById('menuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    if (menuBtn && mobileMenu) {
      menuBtn.addEventListener('click', () => {
        const isOpen = mobileMenu.classList.toggle('hidden');
        const expanded = !isOpen;
        menuBtn.setAttribute('aria-expanded', String(expanded));
        menuBtn.setAttribute('aria-label', expanded ? 'Close menu' : 'Open menu');
      });
    }

    // Select All genres
    const selectAllChk = document.getElementById('selectAll');
    const genreGrid   = document.querySelector('.genre-grid');
    const genreBoxes  = () => Array.from(genreGrid.querySelectorAll('input[type="checkbox"]'));

    function setAllGenres(checked) {
      genreBoxes().forEach(cb => cb.checked = checked);
    }
    function updateSelectAllState() {
      const boxes = genreBoxes();
      const allChecked = boxes.length > 0 && boxes.every(cb => cb.checked);
      selectAllChk.checked = allChecked;
    }

    if (selectAllChk && genreGrid) {
      selectAllChk.addEventListener('change', (e) => setAllGenres(e.target.checked));
      genreGrid.addEventListener('change', updateSelectAllState);
    }
  </script>
</body>
</html>
